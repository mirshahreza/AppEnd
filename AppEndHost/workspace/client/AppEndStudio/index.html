<!DOCTYPE html>
<html lang="en" spellcheck="false" data-bs-theme="light">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="manifest" href="/manifest.json">
    <link rel="icon" href="assets/Logo-Only.png">

    <title>...</title>
    <script>
        const DEVELOPMENT_MODE = true;
    </script>
    <script>
        (function () {
            if ('serviceWorker' in navigator) navigator.serviceWorker.register('/serviceWorker.js', { scope: '/' });
            if (!sessionStorage.length) localStorage.setItem('getSessionStorage', Date.now());
            window.addEventListener('storage', function (event) {
                if (event.key == 'getSessionStorage') {
                    localStorage.setItem('sessionStorage', JSON.stringify(sessionStorage));
                    localStorage.removeItem('sessionStorage');
                } else if (event.key == 'sessionStorage' && !sessionStorage.length) {
                    var data = JSON.parse(event.newValue);
                    for (key in data) {
                        sessionStorage.setItem(key, data[key]);
                    }
                }
            });
        })();
    </script>
    <link href="/a..lib/append-all-ltr.css" rel="stylesheet" />
    <link href="assets/custom.css" rel="stylesheet" />
</head>
<body class="bg-body">
    <div id="app" class="h-100">
        <component-loader v-if="shared.isLogedIn() === true" src="/a.Layouts/Application" cid="studiEnv"></component-loader>
        <component-loader v-else src="/a.SharedComponents/LoginModern" cid="loginEnv" />
    </div>
    <div class="static-working-cover bg-elevated" style="position: fixed;top: 0px;left: 0px;bottom: 0px;right: 0px;height:100%;width:100%;z-index: 2147483638;">
        <div class="static-working-cover-inner" style="position: absolute; top: 50%; left: 50%; -moz-transform: translateX(-50%) translateY(-50%); -webkit-transform: translateX(-50%) translateY(-50%); transform: translateX(-50%) translateY(-50%);">
            <svg style="margin: auto; background-color: transparent; display: block; shape-rendering: auto; width: 170px; height: 170px;"
                 class="ae-static-working-cover-svg" viewBox="0 0 100 100" preserveAspectRatio="xMidYMid">
                <path d="M30 50A20 20 0 0 0 70 50A20 21 0 0 1 30 50" fill="var(--color-accent)" stroke="none">
                    <animateTransform attributeName="transform" type="rotate" dur="2s" repeatCount="indefinite" keyTimes="0;1" values="0 50 50.5;360 50 50.5"></animateTransform>
                </path>
            </svg>
        </div>
    </div>
    <script>
        if (DEVELOPMENT_MODE) {
            // Load individual scripts for better debugging
            document.write('<script src="/a..lib/jquery/jquery-3.7.1.min.js"><\/script>');
            document.write('<script src="/a..lib/bootstrap/js/bootstrap.bundle.min.js"><\/script>');
            document.write('<script src="/a..lib/jstree/jstree.min.js"><\/script>');
            document.write('<script src="/a..lib/bsDateTimePicker/mds.bs.datetimepicker.js"><\/script>');
            document.write('<script src="/a..lib/draganddrop/draganddrop.js"><\/script>');
            document.write('<script src="/a..lib/misc/lodash.js"><\/script>');
            document.write('<script src="/a..lib/misc/jquery.mask.min.js"><\/script>');
            document.write('<script src="/a..lib/ace/src-min/ace.js"><\/script>');
            document.write('<script src="/a..lib/Trumbowyg/trumbowyg.min.js"><\/script>');
            document.write('<script src="/a..lib/croppie/croppie.min.js"><\/script>');
            document.write('<script src="/a..lib/flex-splitter/flex-splitter-directive-0.5.1.js"><\/script>');
            document.write('<script src="/a..lib/OverlayScrollbars/js/jquery.overlayScrollbars.min.js"><\/script>');
            document.write('<script src="/a..lib/vue/vue.global.js"><\/script>');
            document.write('<script src="/a..lib/vue/vue3-sfc-loader.js"><\/script>');
            document.write('<script src="/a..lib/misc/moment.min.js"><\/script>');
            document.write('<script src="/a..lib/append/js/append-core.js"><\/script>');
            document.write('<script src="/a..lib/append/js/append-auth.js"><\/script>');
            document.write('<script src="/a..lib/append/js/append-bi.js"><\/script>');
            document.write('<script src="/a..lib/append/js/append-rpc.js"><\/script>');
            document.write('<script src="/a..lib/append/js/append-theme-manager.js"><\/script>');
            document.write('<script src="/a..lib/append/js/append-vue-loader.js"><\/script>');
            document.write('<script src="/a..lib/append/js/append-window-manager.js"><\/script>');
            document.write('<script src="/a..lib/append/js/append-helpers.js"><\/script>');
            document.write('<script src="/a..lib/append/js/append-formatters.js"><\/script>');
            document.write('<script src="/a..lib/append/js/append-validators.js"><\/script>');
            document.write('<script src="/a..lib/append/js/append-file-utils.js"><\/script>');
            document.write('<script src="/a..lib/append/js/append-plugin-aeFileField.js"><\/script>');
            document.write('<script src="/a..lib/append/js/append-plugin-bsPagination.js"><\/script>');
            document.write('<script src="/a..lib/append/js/append-plugin-bsTabsAutoNav.js"><\/script>');
            document.write('<script src="/a..lib/append/js/append-plugin-dtPicker.js"><\/script>');
            document.write('<script src="/a..lib/append/js/append-plugin-editorBox.js"><\/script>');
            document.write('<script src="/a..lib/append/js/append-plugin-inputsRegulator.js"><\/script>');
            document.write('<script src="/a..lib/append/js/append-plugin-nullableCheckbox.js"><\/script>');
            document.write('<script src="/a..lib/append/js/append-plugin-objectPicker.js"><\/script>');
            document.write('<script src="/a..lib/append/js/append-plugin-operatorInput.js"><\/script>');
            document.write('<script src="/a..lib/append/js/append-plugin-csvToTable.js"><\/script>');
        } else {
            document.write('<script src="/a..lib/append-all.js"><\/script>');
        }
    </script>
    <script src="assets/custom.js"></script>
    <script>
        $(document).ready(function () {
            initPage();
            shared.fake = getFake('dev');
            let wId = showWorking(shared.heavyWorkingCover);
            vApp = Vue.createApp();
            vApp.config.globalProperties.shared = shared;
            vApp.config.warnHandler = () => null;
            vApp.component('component-loader', loadVM("/a.SharedComponents/BaseComponentLoader.vue"));
            if (typeof tryRestoreSessionFromCookie === "function") tryRestoreSessionFromCookie();

            // Vue error handler: display error info in JSON modal
            vApp.config.errorHandler = function (err, vm, info) {
                try {
                    showJson({ type: 'vue-error', message: err && err.message ? err.message : String(err), info: info, stack: err && err.stack ? err.stack : null });
                } catch (e) {
                }
            };

            // Global JS error handler
            window.addEventListener('error', function (ev) {
                try {
                    // Suppress benign ResizeObserver errors caused by browser layout thrashing
                    if (typeof ev.message === 'string' && ev.message.indexOf('ResizeObserver loop completed with undelivered notifications') !== -1) {
                        // Ignore silently
                        return;
                    }
                    var err = ev.error || {};
                    var payload = {
                        type: 'js-error',
                        message: ev.message || (err && err.message) || 'Unknown error',
                        source: ev.filename || ev.filename === undefined ? ev.filename : null,
                        lineno: ev.lineno || null,
                        colno: ev.colno || null,
                        stack: err && err.stack ? err.stack : null
                    };
                    // Use showJson if available, otherwise fallback to alert
                    if (typeof showJson === 'function') showJson(payload);
                    else alert(JSON.stringify(payload, null, 2));
                } catch (e) {
                }
            });

            // Unhandled promise rejections
            window.addEventListener('unhandledrejection', function (ev) {
                try {
                    var reason = ev.reason || {};
                    var payload = {
                        type: 'unhandledrejection',
                        message: reason && reason.message ? reason.message : String(reason),
                        stack: reason && reason.stack ? reason.stack : null
                    };
                    if (typeof showJson === 'function') showJson(payload);
                    else alert(JSON.stringify(payload, null, 2));
                } catch (e) {
                }
            });

            vInstance = vApp.mount("#app");
            $(document).ready(function () { hideWorking(wId); });
        });
    </script>
</body>
</html>